<!DOCTYPE html>

<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UL60691 çƒ­è€åŒ–æµ‹è¯•è®¡ç®—å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        line-height: 1.6;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        overflow: hidden;
    }

    .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
    }

    .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
    }

    .content {
        padding: 40px;
    }

    .alert {
        background: #e3f2fd;
        border-left: 4px solid #2196f3;
        padding: 20px;
        margin-bottom: 30px;
        border-radius: 8px;
    }

    .card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .form-group {
        display: flex;
        flex-direction: column;
    }

    label {
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
    }

    input {
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 1em;
        transition: border-color 0.3s;
    }

    input:focus {
        outline: none;
        border-color: #667eea;
    }

    .btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1.1em;
        font-weight: 600;
        border-radius: 8px;
        cursor: pointer;
        transition: transform 0.2s;
        width: 100%;
    }

    .btn:hover {
        transform: translateY(-2px);
    }

    .result {
        display: none;
        margin-top: 40px;
    }

    .result.show {
        display: block;
    }

    #resultContent {
        margin-top: 20px;
    }

    @media (max-width: 768px) {
        body {
            padding: 0;
            background: white;
        }

        .container {
            border-radius: 0;
        }

        .header {
            padding: 20px 15px;
        }

        .header h1 {
            font-size: 1.3em;
        }

        .content {
            padding: 15px;
        }

        .form-grid {
            grid-template-columns: 1fr;
        }

        input {
            font-size: 16px;
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”¥ UL60691 çƒ­è€åŒ–æµ‹è¯•è®¡ç®—å™¨</h1>
            <p>ç²¾ç¡®è®¡ç®—æµ‹è¯•é˜¶æ®µä¸å®Œæˆæ—¶é—´</p>
        </div>

```
    <div class="content">
        <div class="alert">
            <div style="font-weight: bold; margin-bottom: 8px;">âš ï¸ å†·å´è§„åˆ™è¯´æ˜</div>
            <div>
                â€¢ ä»å¼€å§‹æ—¥æœŸç®—èµ·ï¼Œæ¯å‘¨çš„ç¬¬3å¤©å’Œç¬¬5å¤©éœ€è¦å†·å´12å°æ—¶<br>
                â€¢ å†·å´åœ¨ä¸å¼€å§‹æ—¶é—´ç›¸åŒçš„æ—¶åˆ»å¼€å§‹<br>
                â€¢ ä¾‹å¦‚ï¼š2025/9/2 10:00å¼€å§‹ â†’ 9/4 10:00ã€9/6 10:00å†·å´<br>
                â€¢ è¾“å…¥çš„æ—¶é•¿åŒ…å«å†·å´æ—¶é—´
            </div>
        </div>

        <div class="card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
            <h3 style="margin-bottom: 15px;">ğŸ¯ è¾“å…¥è¯´æ˜</h3>
            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; font-size: 0.95em;">
                <strong>âš ï¸ é‡è¦ï¼š</strong>è¾“å…¥çš„"æ€»ç»è¿‡æ—¶é•¿"å·²åŒ…å«å†·å´æ—¶é—´<br>
                ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—å®é™…è¿è¡Œæ—¶é•¿å’Œå¯¹åº”çš„æµ‹è¯•é˜¶æ®µ<br>
                <br>
                ä¾‹å¦‚ï¼šæµ‹è¯•è½¯ä»¶æ˜¾ç¤º774å°æ—¶ = 666å°æ—¶è¿è¡Œ + 108å°æ—¶å†·å´
            </div>
        </div>

        <div class="form-grid">
            <div class="form-group">
                <label for="startDate">å¼€å§‹æ—¥æœŸ</label>
                <input type="date" id="startDate">
            </div>
            <div class="form-group">
                <label for="startTime">å¼€å§‹æ—¶é—´</label>
                <input type="time" id="startTime">
            </div>
            <div class="form-group">
                <label for="totalHours">æ€»ç»è¿‡æ—¶é•¿ï¼ˆå°æ—¶ï¼‰</label>
                <input type="number" id="totalHours" placeholder="åŒ…å«å†·å´æ—¶é—´ï¼Œä¾‹å¦‚: 774">
            </div>
        </div>

        <button class="btn" onclick="calculate()">ğŸš€ å¼€å§‹è®¡ç®—</button>

        <div id="result" class="result">
            <div id="resultContent"></div>
        </div>
    </div>
</div>

<script>
    const testStages = [
        { name: 'A', duration: 336, temp: 35, type: '2å‘¨' },
        { name: 'B', duration: 336, temp: 25, type: '2å‘¨' },
        { name: 'C', duration: 168, temp: 20, type: '1å‘¨' },
        { name: 'D', duration: 168, temp: 15, type: '1å‘¨' },
        { name: 'E', duration: 168, temp: 10, type: '1å‘¨' },
        { name: 'F', duration: 168, temp: 5, type: '1å‘¨' },
        { name: 'G', duration: 24, temp: 'Tc+5K', type: '1å¤©' }
    ];

    function calculate() {
        const startDate = document.getElementById('startDate').value;
        const startTime = document.getElementById('startTime').value;
        const totalHoursInput = parseFloat(document.getElementById('totalHours').value);

        if (!startDate || !startTime || isNaN(totalHoursInput)) {
            alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹');
            return;
        }

        const start = new Date(startDate + 'T' + startTime);
        
        // æ¨¡æ‹Ÿæ—¶é—´æµé€è®¡ç®—å®é™…è¿è¡Œæ—¶é•¿
        let currentDate = new Date(start);
        let actualRunHours = 0;
        let coolingCount = 0;
        let elapsedHours = 0;
        const cooledDays = new Set();

        while (elapsedHours < totalHoursInput) {
            const diff = currentDate - start;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const dayInWeek = (days % 7) + 1;
            
            const isCoolingDay = (dayInWeek === 3 || dayInWeek === 5);
            const isCoolingMoment = (currentDate.getHours() === start.getHours() && 
                                    currentDate.getMinutes() === start.getMinutes());
            const dayKey = days + '-' + dayInWeek;
            
            if (isCoolingDay && isCoolingMoment && !cooledDays.has(dayKey)) {
                const remainingHours = totalHoursInput - elapsedHours;
                const coolingHours = Math.min(12, remainingHours);
                currentDate = new Date(currentDate.getTime() + coolingHours * 3600000);
                elapsedHours += coolingHours;
                coolingCount++;
                cooledDays.add(dayKey);
                if (coolingHours < 12) break;
                continue;
            }
            
            const step = Math.min(1, totalHoursInput - elapsedHours);
            currentDate = new Date(currentDate.getTime() + step * 3600000);
            elapsedHours += step;
            actualRunHours += step;
        }

        // æ‰¾å‡ºå½“å‰é˜¶æ®µ
        let accumulated = 0;
        let currentStage = null;
        let stageProgress = 0;

        for (let stage of testStages) {
            if (accumulated + stage.duration >= actualRunHours) {
                currentStage = stage;
                stageProgress = actualRunHours - accumulated;
                break;
            }
            accumulated += stage.duration;
        }

        if (!currentStage) {
            currentStage = { name: 'å·²å®Œæˆ', duration: 0, temp: '-' };
        }

        // è®¡ç®—å„é˜¶æ®µçš„å¼€å§‹å’Œç»“æŸæ—¶é—´
        const stageTimeline = [];
        let prevEndDate = new Date(start);
        let accHours = 0;

        for (let stage of testStages) {
            const stageStart = new Date(prevEndDate);
            accHours += stage.duration;
            
            // è®¡ç®—è¯¥é˜¶æ®µç»“æŸæ—¶é—´å’Œå†·å´æ¬¡æ•°
            let stageEndDate = new Date(start);
            let runHours = 0;
            let stageCoolingCount = 0;
            const cooled = new Set();

            while (runHours < accHours) {
                const diff = stageEndDate - start;
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const dayInWeek = (days % 7) + 1;
                const isCoolingDay = (dayInWeek === 3 || dayInWeek === 5);
                const isCoolingMoment = (stageEndDate.getHours() === start.getHours() && 
                                        stageEndDate.getMinutes() === start.getMinutes());
                const dayKey = days + '-' + dayInWeek;
                
                if (isCoolingDay && isCoolingMoment && !cooled.has(dayKey)) {
                    stageEndDate = new Date(stageEndDate.getTime() + 12 * 3600000);
                    stageCoolingCount++;
                    cooled.add(dayKey);
                    continue;
                }
                
                stageEndDate = new Date(stageEndDate.getTime() + 3600000);
                runHours++;
            }

            const duration = (stageEndDate - stageStart) / (1000 * 60 * 60 * 24);
            const isCompleted = accHours <= actualRunHours;
            const isCurrent = accHours > actualRunHours && (accHours - stage.duration) < actualRunHours;

            stageTimeline.push({
                name: stage.name,
                duration: stage.duration,
                accumulated: accHours,
                startDate: stageStart,
                endDate: stageEndDate,
                durationDays: duration,
                coolingCount: stageCoolingCount,
                isCompleted: isCompleted,
                isCurrent: isCurrent
            });

            prevEndDate = stageEndDate;
        }

        // æ˜¾ç¤ºç»“æœ
        let resultHTML = `
            <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h3 style="margin-bottom: 20px;">ğŸ“Š è®¡ç®—ç»“æœ</h3>
                <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <div style="font-size: 0.9em; opacity: 0.9;">ğŸ¯ è¿è¡Œåˆ°æ­¤æ—¶åˆ»</div>
                    <div style="font-size: 1.5em; font-weight: bold;">${currentDate.toLocaleString('zh-CN')}</div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px;">
                        <div style="font-size: 0.8em; opacity: 0.8;">å½“å‰é˜¶æ®µ</div>
                        <div style="font-size: 1.4em; font-weight: bold;">é˜¶æ®µ ${currentStage.name}</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px;">
                        <div style="font-size: 0.8em; opacity: 0.8;">é˜¶æ®µæ¸©åº¦</div>
                        <div style="font-size: 1.4em; font-weight: bold;">${currentStage.temp}Â°K</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px;">
                        <div style="font-size: 0.8em; opacity: 0.8;">é˜¶æ®µè¿›åº¦</div>
                        <div style="font-size: 1.4em; font-weight: bold;">${stageProgress.toFixed(1)}/${currentStage.duration}h</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px;">
                        <div style="font-size: 0.8em; opacity: 0.8;">æ€»ä½“è¿›åº¦</div>
                        <div style="font-size: 1.4em; font-weight: bold;">${((actualRunHours/1368)*100).toFixed(1)}%</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 style="margin-bottom: 15px;">â±ï¸ æ—¶é—´ä¿¡æ¯</h3>
                <div style="padding: 10px; background: #fff5f5; border-radius: 6px; margin-bottom: 10px;">
                    <strong>ğŸ“¥ è¾“å…¥çš„æ€»ç»è¿‡æ—¶é•¿ï¼š</strong> ${totalHoursInput} å°æ—¶
                </div>
                <div style="padding: 10px; background: #f0f7ff; border-radius: 6px; margin-bottom: 10px;">
                    <strong>ğŸ“ å®é™…è¿è¡Œæ—¶é•¿ï¼š</strong> ${actualRunHours.toFixed(1)} å°æ—¶
                </div>
                <div style="padding: 10px; background: #f1f8f4; border-radius: 6px; margin-bottom: 10px;">
                    <strong>â„ï¸ å†·å´æ¬¡æ•°ï¼š</strong> ${coolingCount} æ¬¡ (${coolingCount * 12} å°æ—¶)
                </div>
                <div style="padding: 10px; background: #fffbea; border-radius: 6px; font-size: 0.9em;">
                    ğŸ’¡ <strong>è¯´æ˜ï¼š</strong>è¾“å…¥${totalHoursInput}å°æ—¶ = ${actualRunHours.toFixed(0)}å°æ—¶è¿è¡Œ + ${(coolingCount * 12)}å°æ—¶å†·å´
                </div>
            </div>
        `;

        // æ·»åŠ é˜¶æ®µæ—¶é—´è¡¨
        let timelineHTML = `
            <div class="card" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <h3 style="margin-bottom: 15px; color: #333;">ğŸ—“ï¸ å„é˜¶æ®µæ—¶é—´æ˜ç»†</h3>
                <div style="background: rgba(255,255,255,0.7); padding: 12px; border-radius: 6px; margin-bottom: 15px; font-size: 0.9em; color: #333;">
                    <strong>ğŸ“Œ è¯´æ˜ï¼š</strong>æ˜¾ç¤ºæ¯ä¸ªé˜¶æ®µçš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼ˆå·²åŒ…å«å†·å´æ—¶é—´çš„å½±å“ï¼‰
                </div>
        `;

        for (let i = 0; i < stageTimeline.length; i++) {
            const st = stageTimeline[i];
            const statusColor = st.isCurrent ? '#2196f3' : (st.isCompleted ? '#4caf50' : '#999');
            const statusText = st.isCurrent ? 'â— è¿›è¡Œä¸­' : (st.isCompleted ? 'âœ“ å·²å®Œæˆ' : 'â—‹ æœªå¼€å§‹');
            const bgColor = st.isCurrent ? '#e3f2fd' : (st.isCompleted ? '#f1f8f4' : 'white');
            
            const startTimeStr = st.startDate.toLocaleString('zh-CN', {
                month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', weekday: 'short'
            });
            const endTimeStr = st.endDate.toLocaleString('zh-CN', {
                month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', weekday: 'short'
            });

            timelineHTML += `
                <div style="background: ${bgColor}; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid ${statusColor};">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div style="font-size: 1.1em; font-weight: bold; color: ${statusColor};">é˜¶æ®µ ${st.name}</div>
                        <div style="color: ${statusColor}; font-weight: 600;">${statusText}</div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; font-size: 0.9em;">
                        <div><strong>æœ¬é˜¶æ®µæ—¶é•¿ï¼š</strong>${st.duration}h</div>
                        <div><strong>ç´¯è®¡è¿è¡Œï¼š</strong>${st.accumulated}h</div>
                        <div style="color: #27ae60;"><strong>â–¶ å¼€å§‹ï¼š</strong>${startTimeStr}</div>
                        <div style="color: ${statusColor};"><strong>â¹ ç»“æŸï¼š</strong>${endTimeStr}</div>
                        <div><strong>æŒç»­å¤©æ•°ï¼š</strong>${st.durationDays.toFixed(1)} å¤©</div>
                        <div><strong>â„ï¸ å†·å´æ¬¡æ•°ï¼š</strong>${st.coolingCount} æ¬¡ (${st.coolingCount * 12}h)</div>
                    </div>
                </div>
            `;
        }

        timelineHTML += `
                <div style="margin-top: 15px; padding: 10px; background: white; border-radius: 6px; font-size: 0.85em; color: #666;">
                    ğŸ’¡ æ€»æµ‹è¯•æ—¶é•¿: 1368 å°æ—¶ (57å¤©ï¼Œçº¦8å‘¨)
                </div>
            </div>
        `;

        resultHTML += timelineHTML;

        document.getElementById('resultContent').innerHTML = resultHTML;
        document.getElementById('result').classList.add('show');
        document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
    }
</script>
```

</body>
</html>
